# Copyright (c) 2021 Markus Falb <markus.falb@mafalb.at>
# GNU General Public License v3.0+
# see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt
---

- name: ansible version
  mafalb.ansible.ansible_info:
  register: __ansible_version
- block:
    - name: debug
      debug: var=ansible_version
    - name: debug
      debug: var=__ansible_version
    - name: debug
      debug: var=__ansible_version.version.major|type_debug
- name: assertions
  assert:
    that:
      - __ansible_version.version.major|type_debug == 'int'
      - __ansible_version.version.major == 2
      - __ansible_version.version.minor|type_debug == 'int'
      - (ansible_version.major|string
         + '.'
         + ansible_version.minor|string
        ) == __ansible_version.version.majmin
    fail_msg: "assertions failed for {{ __ansible_version }}"

...
