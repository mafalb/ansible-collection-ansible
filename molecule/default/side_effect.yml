# vim: set ft=yaml ts=2 expandtab:
---

- name: test collection and role creation
  hosts: all,!t_centos6,!t_ubuntuxenial

  tasks:

  - name: include list of virtualenvs
    include_vars: vars/virtualenvs.yml

  # kind of quirky
  # copy src files to CI node
  #
  - name: the playbooks and supporting files are present # noqa 208
    copy:
      src: ../../playbooks/{{ item }}
      dest: /tmp/
    loop:
    - collection-init.yml
    - role-init.yml
    - files
    - templates

  - name: test collection and role creation
    include_tasks: test_playbooks.yml
    loop: "{{ virtualenvs[:2]|map(attribute='virtualenv')|list }}"
    loop_control:
      loop_var: _ansibleversion

...
